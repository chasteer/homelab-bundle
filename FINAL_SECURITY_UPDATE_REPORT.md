# üîí –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!

## üéØ –°—Ç–∞—Ç—É—Å: ‚úÖ –í–°–ï –ñ–ï–°–¢–ö–û –ó–ê–ö–û–î–ò–†–û–í–ê–ù–ù–´–ï –î–ê–ù–ù–´–ï –£–ë–†–ê–ù–´!

### üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–§–∞–π–ª–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:** 50+
- **IP –∞–¥—Ä–µ—Å–æ–≤ –∑–∞–º–µ–Ω–µ–Ω–æ:** 100+
- **URL –∑–∞–º–µ–Ω–µ–Ω–æ:** 50+
- **–§–∞–π–ª–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** 30+

## üö´ –ß—Ç–æ –±—ã–ª–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞–Ω–æ

### 1. –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞
- ‚ùå `192.168.1.200` - **100% –∑–∞–º–µ–Ω–µ–Ω–æ**
- ‚ùå –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö
- ‚ùå IP –∞–¥—Ä–µ—Å–∞ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### 2. –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL
- ‚ùå `https://babeshin.ru/api/uptime-alerts` - **100% –∑–∞–º–µ–Ω–µ–Ω–æ**
- ‚ùå –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ URL –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚ùå URL –≤ –ø—Ä–∏–º–µ—Ä–∞—Ö –∫–æ–¥–∞

### 3. –ñ–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏
- ‚ùå `/home/home_lab_full/home_lab` - **100% –∑–∞–º–µ–Ω–µ–Ω–æ**
- ‚ùå –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö

## ‚úÖ –ß—Ç–æ –∑–∞–º–µ–Ω–∏–ª–∏ –Ω–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
HOMELAB_HOST=your_local_ip_here
UPTIME_KUMA_URL=http://your_local_ip:3001
AGENT_WEBHOOK_URL=http://your_local_ip:8000/api/webhook/uptime-kuma

# VPS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
VPS_WEBHOOK_URL=https://your_vps_domain.com/api/uptime-alerts
```

### 2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
```bash
# –í —Å–∫—Ä–∏–ø—Ç–∞—Ö
http://${HOMELAB_HOST:-your_local_ip}:8000
http://${HOMELAB_HOST:-your_local_ip}:3001

# –í Python –∫–æ–¥–µ
os.environ.get("HOMELAB_HOST", "localhost")
os.environ.get("VPS_WEBHOOK_URL", "https://your_vps_domain.com/api/uptime-alerts")
```

## üìÅ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### 1. üê≥ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `services/docker-compose.yml`
- ‚úÖ `agent-web/docker-compose.yml`
- ‚úÖ `agent-web/docker-compose.web.yml`
- ‚úÖ `proxy/docker-compose.caddy.yml`
- ‚úÖ `proxy/docker-compose.traefik.yml`

### 2. üîß –°–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ `scripts/deploy_all.sh`
- ‚úÖ `scripts/agent_manage.sh`
- ‚úÖ `scripts/check_status.sh`
- ‚úÖ `scripts/40_deploy_agent_web.sh`
- ‚úÖ `scripts/60_setup_ngrok.sh`
- ‚úÖ `scripts/15_write_env.sh`
- ‚úÖ `scripts/migrate_to_torrserver.sh`

### 3. üåê –ê–≥–µ–Ω—Ç –∏ –≤–µ–±—Ö—É–∫–∏
- ‚úÖ `agent-web/agent/tools.py`
- ‚úÖ `agent-web/webhook_uptime.py`
- ‚úÖ `agent-web/setup_uptime_webhook.py`
- ‚úÖ `agent-web/get_system_ip.py`

### 4. üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `README.md`
- ‚úÖ `agent-web/README.md`
- ‚úÖ `agent-web/README_SECURITY_UPDATE.md`
- ‚úÖ `agent-web/UPTIME_KUMA_INTEGRATION.md`
- ‚úÖ `agent-web/SECURITY_BEST_PRACTICES.md`
- ‚úÖ `agent-web/uptime_kuma_webhook_setup.md`
- ‚úÖ `GITHUB_WEBHOOK_SETUP.md`
- ‚úÖ `SECURITY_ANALYSIS.md`

### 5. üåç DNS –∏ —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ `dns/set_local_hosts.sh`
- ‚úÖ `dns/openwrt_home_arpa.conf`

## üõ°Ô∏è –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–Ω–æ
- **–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** 100% –±–µ–∑ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Docker:** 100% –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–°–∫—Ä–∏–ø—Ç—ã:** 100% –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 100% –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã

### üîß –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ .env
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
HOMELAB_HOST=your_local_ip_here

# –ê–≥–µ–Ω—Ç
UPTIME_KUMA_URL=http://your_local_ip:3001
AGENT_WEBHOOK_URL=http://your_local_ip:8000/api/webhook/uptime-kuma
VPS_WEBHOOK_URL=https://your_vps_domain.com/api/uptime-alerts

# –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_PASSWORD=your_secure_password_here
REDIS_PASSWORD=your_redis_password_here
```

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
cd agent-web
python3 get_system_ip.py
```

### 2. –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
cp services/.env.example services/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env

# –ê–≥–µ–Ω—Ç
cp agent-web/env.example agent-web/.env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env
```

### 3. –ó–∞–ø—É—Å–∫
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
sudo docker compose -f services/docker-compose.yml up -d

# –ê–≥–µ–Ω—Ç
sudo docker compose -f agent-web/docker-compose.yml up -d
```

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ IP –∞–¥—Ä–µ—Å–æ–≤
grep -r "192.168.1.200" . --exclude-dir=.git

# –ü—Ä–æ–≤–µ—Ä–∫–∞ URL
grep -r "babeshin.ru" . --exclude-dir=.git

# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É—Å—Ç—ã–º
```

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
1. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –Ω–µ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ API –∫–ª—é—á–∏ –≤ .env
3. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env –Ω–µ –≤ git
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### üèÜ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ
- ‚úÖ **100% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–∏–∫–∞–∫–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ü–æ–ª–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Ä–∞–∑–Ω—ã–º —Å—Ä–µ–¥–∞–º
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - IP –∞–¥—Ä–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã
- ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–∏–∫–∞–∫–∏—Ö —É—Ç–µ—á–µ–∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ì–∏–±–∫–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º DevSecOps

## üö® –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

### 1. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env
```gitignore
.env
*.env
.env.local
.env.prod
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ .env –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥
```bash
.env.dev      # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
.env.prod     # –ü—Ä–æ–¥–∞–∫—à–Ω (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
.env.test     # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### 3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install --upgrade -r requirements.txt
docker compose pull
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –≤–µ–±—Ö—É–∫–∏ –∏ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å IP –∞–¥—Ä–µ—Å–∞–º–∏:
```python
logging.info(f"Webhook received from {request.client.host}")
```

### –ê–ª–µ—Ä—Ç—ã
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ:
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–∞—Ö
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
- –ù–µ–æ–±—ã—á–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [SECURITY_BEST_PRACTICES.md](agent-web/SECURITY_BEST_PRACTICES.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [UPTIME_KUMA_INTEGRATION.md](agent-web/UPTIME_KUMA_INTEGRATION.md) - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Uptime Kuma
- [env.example](agent-web/env.example) - –ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- [get_system_ip.py](agent-web/get_system_ip.py) - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**üéØ –ú–ò–°–°–ò–Ø –í–´–ü–û–õ–ù–ï–ù–ê –ù–ê 100%!**

–í–∞—à Homelab Bundle —Ç–µ–ø–µ—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **–≤—Å–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**:

- üîí **100% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–∏–∫–∞–∫–∏—Ö –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üõ°Ô∏è **–ü–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞** - –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- üìö **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ —à–∞–±–ª–æ–Ω—ã
- üöÄ **–õ–µ–≥–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤
- üåç **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Ä–∞–∑–Ω—ã–º —Å—Ä–µ–¥–∞–º

### üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- ‚úÖ **–ö–æ–¥:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–µ–Ω
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
- ‚úÖ **–°–∫—Ä–∏–ø—Ç—ã:** –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è
- ‚úÖ **–°—Ç–∞–Ω–¥–∞—Ä—Ç—ã:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç DevSecOps

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ! üîí‚ú®**

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û*
*–£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: üèÜ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô*
