# üîí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - Homelab Agent

## üö® –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –£–±—Ä–∞–Ω—ã –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞
**–ë—ã–ª–æ:**
```python
KUMA_URL = "http://your_local_ip:3001"
VPS_URL = "https://your_vps_domain.com/api/uptime-alerts"
host = "your_local_ip"
```

**–°—Ç–∞–ª–æ:**
```python
KUMA_URL = os.environ.get("UPTIME_KUMA_URL", "http://localhost:3001")
VPS_URL = os.environ.get("VPS_WEBHOOK_URL", "https://your_vps_domain.com/api/uptime-alerts")
host = os.environ.get("HOMELAB_HOST", "localhost")
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã
- ‚úÖ `webhook_uptime.py` - –≤—Å–µ URL –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `agent/tools.py` - IP –∞–¥—Ä–µ—Å–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `setup_uptime_webhook.py` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ URL
- ‚úÖ `docker-compose.yml` - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ `UPTIME_KUMA_INTEGRATION.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üõ°Ô∏è –ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```bash
# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
HOMELAB_HOST=your_local_ip_here
UPTIME_KUMA_URL=http://your_local_ip:3001
AGENT_WEBHOOK_URL=http://your_local_ip:8000/api/webhook/uptime-kuma

# VPS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
VPS_WEBHOOK_URL=https://your_vps_domain.com/api/uptime-alerts
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```bash
# –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
HOMELAB_HOST=${HOMELAB_HOST:-localhost}
UPTIME_KUMA_URL=${UPTIME_KUMA_URL:-http://localhost:3001}
VPS_WEBHOOK_URL=${VPS_WEBHOOK_URL:-https://your_vps_domain.com/api/uptime-alerts}
```

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –°–∫—Ä–∏–ø—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP
```bash
python3 get_system_ip.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç IP –∞–¥—Ä–µ—Å–∞ —Å–∏—Å—Ç–µ–º—ã
2. –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª `.env` —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
3. –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–π —Å–µ—Ç–∏

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞
```
üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –∞–¥—Ä–µ—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã...
üì± –õ–æ–∫–∞–ª—å–Ω—ã–π IP: your_local_ip
üåê IP –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: your_local_ip
üåç –í–Ω–µ—à–Ω–∏–π IP: your_external_ip

üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π IP –¥–ª—è HOMELAB_HOST: your_local_ip
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```
agent-web/
‚îú‚îÄ‚îÄ .env                    # –í–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ env.example            # –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îú‚îÄ‚îÄ get_system_ip.py       # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP
‚îú‚îÄ‚îÄ SECURITY_BEST_PRACTICES.md  # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README_SECURITY_UPDATE.md   # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
python3 get_system_ip.py

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
```

### 2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
```bash
# API –∫–ª—é—á–∏
GIGACHAT_CREDENTIALS=your_real_credentials
TAVILY_API_KEY=your_real_api_key
GITHUB_TOKEN=your_real_token

# –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
HOMELAB_HOST=your_local_ip
UPTIME_KUMA_URL=http://your_ip:3001
VPS_WEBHOOK_URL=https://your_vps.com/api/endpoint
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
```bash
sudo docker compose down
sudo docker compose up -d --build
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
python3 get_system_ip.py
```

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–¥–µ –Ω–µ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ API –∫–ª—é—á–∏ –≤ .env
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ .env –Ω–µ –≤ git
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

## üö® –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

### 1. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env
```gitignore
# .gitignore
.env
*.env
.env.local
.env.prod
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ .env –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥
```bash
.env.dev      # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
.env.prod     # –ü—Ä–æ–¥–∞–∫—à–Ω (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
.env.test     # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### 3. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install --upgrade -r requirements.txt
docker compose pull
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –≤–µ–±—Ö—É–∫–∏ –∏ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å IP –∞–¥—Ä–µ—Å–∞–º–∏:
```python
logging.info(f"Webhook received from {request.client.host}")
```

### –ê–ª–µ—Ä—Ç—ã
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ:
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–∞—Ö
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö
- –ù–µ–æ–±—ã—á–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [SECURITY_BEST_PRACTICES.md](SECURITY_BEST_PRACTICES.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [UPTIME_KUMA_INTEGRATION.md](UPTIME_KUMA_INTEGRATION.md) - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Uptime Kuma
- [env.example](env.example) - –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –≤–∞—à Homelab Agent:
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–µ–Ω** - –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ **–ì–∏–±–æ–∫** - –ª–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω** - IP –∞–¥—Ä–µ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω** - –ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
2. üîÑ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
3. üöÄ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Uptime Kuma
4. üì± –ù–∞—Å—Ç—Ä–æ–π—Ç–µ VPS –∏ Telegram –±–æ—Ç–∞

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å, –∞ –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ! üîí‚ú®
