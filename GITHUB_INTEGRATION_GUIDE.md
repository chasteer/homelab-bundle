# GitHub Integration Guide

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

GitHub webhook –Ω–µ –º–æ–∂–µ—Ç –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω—ã `.home.arpa`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏.

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** ngrok –∏ cloudflared –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö.

## üîß –†–µ—à–µ–Ω–∏—è

### 1. **ngrok —Ç—É–Ω–Ω–µ–ª—å** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) üåê

**–ü–ª—é—Å—ã:**
- ‚úÖ –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚úÖ HTTPS –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- ‚ùå URL –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É
- ‚ùå **–ú–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö**

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
./scripts/60_setup_ngrok.sh
```

### 2. **Polling** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω) üîÑ

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π URL
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ**
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ 5 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- ‚ùå –ë–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ GitHub API
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
./scripts/70_setup_github_polling.sh
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```bash
./scripts/75_manage_polling.sh status    # –°—Ç–∞—Ç—É—Å
./scripts/75_manage_polling.sh test      # –¢–µ—Å—Ç
./scripts/75_manage_polling.sh logs      # –õ–æ–≥–∏
```

### 3. **SSH —Ç—É–Ω–Ω–µ–ª—å —á–µ—Ä–µ–∑ VPS** (–µ—Å–ª–∏ –µ—Å—Ç—å VPS) üåê

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
- ‚úÖ –í—ã—Å–æ–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ**

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù—É–∂–µ–Ω VPS
- ‚ùå –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ùå –ù—É–∂–µ–Ω –¥–æ–º–µ–Ω

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
./scripts/80_setup_ssh_tunnel.sh
```

### 4. **Cloudflare Tunnel** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) ‚òÅÔ∏è

**–ü–ª—é—Å—ã:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
- ‚úÖ –í—ã—Å–æ–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ –•–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚ùå –ù—É–∂–µ–Ω –¥–æ–º–µ–Ω
- ‚ùå –¢—Ä–µ–±—É–µ—Ç Cloudflare –∞–∫–∫–∞—É–Ω—Ç
- ‚ùå **–ú–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö**

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ï—Å–ª–∏ ngrok/cloudflared –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã:
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ polling** - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ, –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è.

### –ï—Å–ª–∏ –µ—Å—Ç—å VPS:
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH —Ç—É–Ω–Ω–µ–ª—å** - –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω.

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok** - –±—ã—Å—Ç—Ä–æ, –ø—Ä–æ—Å—Ç–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ.

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω):
**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Cloudflare Tunnel** - —Å—Ç–∞–±–∏–ª—å–Ω–æ, –Ω–∞–¥–µ–∂–Ω–æ.

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ** –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ GitHub webhook** (–¥–ª—è ngrok/Cloudflare)
4. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π PR** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –î–ª—è webhook:
1. –°–æ–∑–¥–∞–π—Ç–µ PR –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞: `sudo journalctl -u homelab-agent-web`
3. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –∞–≥–µ–Ω—Ç–∞

### –î–ª—è polling:
1. –°–æ–∑–¥–∞–π—Ç–µ PR –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –¥–æ 5 –º–∏–Ω—É—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `sudo journalctl -u github-polling.service`
4. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –∞–≥–µ–Ω—Ç–∞

## üõ†Ô∏è Troubleshooting

### ngrok –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo systemctl status ngrok-agent

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
sudo journalctl -u ngrok-agent.service

# –ü–æ–ª—É—á–∏—Ç–µ URL —Ç—É–Ω–Ω–µ–ª—è
./scripts/get_tunnel_url.sh
```

### Polling –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo systemctl status github-polling.timer

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
sudo journalctl -u github-polling.service

# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
./github-polling/check_pr.sh
```

### Webhook –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö GitHub
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ä–µ—Ç webhook
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç—É–Ω–Ω–µ–ª—å –∞–∫—Ç–∏–≤–µ–Ω

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–¥–∞–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å GitHub API
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Ç—É–Ω–Ω–µ–ª—è (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
